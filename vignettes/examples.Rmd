---
title: "<span style = 'color: grey;'> A Practical Guide to Statistical Power and Sample Size Calculations in R </span>"
date: "`r Sys.Date()`"
author: Metin Bulus
output:
  rmarkdown::html_document: # html_vignette: 
    toc: true
    number_sections: true
    toc_float: true
    toc_depth: 2
vignette: >
  %\VignetteIndexEntry{A Practical Guide to Statistical Power and Sample Size Calculations in R}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(pwrss)
```

If you find the package and related material useful please cite as:

<div style = "background-color:rgb(245, 245, 245); padding:2px 30px 2px 30px;">
Bulus, M. (2023). pwrss: Statistical Power and Sample Size Calculation Tools. R package version 0.3.0. [https://CRAN.R-project.org/package=pwrss](https://CRAN.R-project.org/package=pwrss)

Bulus, M., & Polat, C. (2023). pwrss R paketi ile istatistiksel güç analizi [Statistical power analysis with pwrss R package]. [https://osf.io/ua5fc](https://osf.io/ua5fc)
</div>

Install and load pwrss R package:

```{r,  message = FALSE, eval = FALSE, warning = FALSE}
install.packages("pwrss")
library(pwrss)
```

Please send any bug reports, feedback, or questions to [bulusmetin [at] gmail.com](mailto:bulusmetin@gmail.com)

# Generic Functions
<div style = "background-color:rgb(247, 247, 247); box-shadow: 4px 4px 4px rgb(220, 220, 220); padding:3px 3px 3px 3px; margin-top:0px; margin-bottom:10px;"></div>

These generic functions calculate and return statistical power along with optional Type I and Type II error plots (as long as the test statistic and degrees of freedom is known). These functions are handy because _z_, _t_, $\chi^{2}$, and _F_ statistics and associated degress of freedom can be readily found in reports, published articles, or standard software output (SAS, SPSS, Jamovi, etc.). Statistical power can be calculated via putting the test statistics for `ncp` in the functions below; however, do not to overinterpret power rates if calculated post hoc. 

## *t* Test

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
power.t.test(ncp = 1.96, df = 99, alpha = 0.05,
             alternative = "equivalent", plot = TRUE)
```

## *z* Test

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
power.z.test(ncp = 1.96, alpha = 0.05, 
             alternative = "not equal", plot = TRUE)
```

## $\chi^2$ Test

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
power.chisq.test(ncp = 2, df = 98,
                 alpha = 0.05, plot = TRUE)
```

## *F* Test

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
power.f.test(ncp = 2, df1 = 2, df2 = 98,
             alpha = 0.05, plot = TRUE)
```

## Multiple Parameters

Multiple parameters are allowed but plots should be turned off (`plot = FALSE`). 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
power.t.test(ncp = c(0.50, 1.00, 1.50, 2.00, 2.50), plot = FALSE,
             df = 99, alpha = 0.05, alternative = "not equal")

power.z.test(alpha = c(0.001, 0.010, 0.025, 0.050), plot = FALSE,
             ncp = 1.96, alternative = "greater")

power.chisq.test(df = c(80, 90, 100, 120, 150, 200), plot = FALSE, 
                 ncp = 2, alpha = 0.05)

```

## Type I and Type II Error Plots

`plot()` function (S3 method) is a wrapper around the generic functions above. Assign results of any `pwrss` function to an R object and pass it to `plot()` function. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = FALSE, warning = FALSE}
# comparing two means
design1 <- pwrss.t.2means(mu1 = 0.20, margin = -0.05, paired = TRUE,
                          power = 0.80, alpha = 0.05,
                          alternative = "non-inferior")
plot(design1)

# ANCOVA design
design2 <- pwrss.f.ancova(eta2 = 0.10, n.levels = c(2,3),
                          power = .80, alpha = 0.05)
plot(design2)

# indirect effect in mediation analysis
design3 <- pwrss.z.med(a = 0.10, b = 0.20, cp = 0.10,
                       power = .80, alpha = 0.05)
plot(design3)

```

<br>
<br>

# Difference between Two Means
<div style = "background-color:rgb(247, 247, 247); box-shadow: 4px 4px 4px rgb(220, 220, 220); padding:3px 3px 3px 3px; margin-top:0px; margin-bottom:10px;"></div>

## Parametric Tests 

### Independent Samples *t* Test

More often than not, unstandardized means and standard deviations are reported in publications for descriptive purposes. Another reason is that they are more intuative and interpretable (e.g. depression scale). Assume that for the first and second groups expected means are 30 and 12, and expected standard deviations are 12 and 8, respectively. 

**Calculate Statistical Power**

What is the statistical power given that the sample size for group 2 is 50 and groups have equal sample sizes (`kappa = n1 / n2 = 1`)?  

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.t.2means(mu1 = 30, mu2 = 28, sd1 = 12, sd2 = 8, kappa = 1, 
               n2 = 50, alpha = 0.05,
               alternative = "not equal")
```

**Calculate Minimum Required Sample Size** 

What is the minimum required sample size given that groups have equal sample sizes (`kappa = n1 / n2 = 1`)?  

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.t.2means(mu1 = 30, mu2 = 28, sd1 = 12, sd2 = 8, kappa = 1, 
               power = .80, alpha = 0.05,
               alternative = "not equal")
```

It is sufficient to put pooled standard deviation for `sd1` because `sd2 = sd1` by default. In this case, for a pooled standard deviation of 10.198 the minimum required sample size can be calculated as

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.t.2means(mu1 = 30, mu2 = 28, sd1 = 10.198, kappa = 1,
               power = .80, alpha = 0.05,
               alternative = "not equal")
```

It is sufficient to put Cohen's *d* or Hedge's *g* (standardized difference between two groups) for `mu1` because `mu2 = 0`, `sd1 = 1`, and `sd2 = sd1` by default. For example, for an effect size as small as 0.196 (based on previous example) the minimum required sample size can be calculated as
```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.t.2means(mu1 = 0.196, kappa = 1,
               power = .80, alpha = 0.05, 
               alternative = "not equal")
```

### Paired Samples *t* Test

Assume for the first (e.g. pretest) and second (e.g. posttest) time points expected means are 30 and 12 (a reduction of 8 points), and expected standard deviations are 12 and 8, respectively. Also assume a correlation of 0.50 (the default in the function) between first and second measurements. What is the minimum required sample size? 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.t.2means(mu1 = 30, mu2 = 28, sd1 = 12, sd2 = 8, 
               paired = TRUE, paired.r = 0.50,
               power = .80, alpha = 0.05,
               alternative = "not equal")
```

It is sufficient to put standard deviation of the difference for `sd1` because `sd2 = sd1` by default. In this case, for a standard deviation of difference of 10.583 the minimum required sample size can be calculated as

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.t.2means(mu1 = 30, mu2 = 28, sd1 = 10.583, 
               paired = TRUE, paired.r = 0.50,
               power = .80, alpha = 0.05,
               alternative = "not equal")
```

It is sufficient to put Cohen's *d* or Hedge's *g* (standardized difference between two groups) for `mu1` because `mu2 = 0`, `sd1 = sqrt(1/(2*(1-paired.r)))`, and `sd2 = sd1` by default. For example, for an effect size as small as 0.1883 (based on previous example) the minimum required sample size can be calculated as

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.t.2means(mu1 = 0.1883, paired = TRUE, paired.r = 0.50,
               power = .80, alpha = 0.05, 
               alternative = "not equal")
```

## Non-parametric Tests 

The variable of interest for which means are compared between two groups (or between two time points) may not follow normal distribution. 
In this case *t* test could produce biased results. One reason is that the sample size could be small. Another reason is that the parent distribution (distribution in the population) may not follow normal distribution (e.g., uniform, exponential, double exponential, or logistic). 

For non-parametric tests use `pwrss.np.2means()` function instead of `pwrss.t.2means()`. All arguments are same. Additionally, however, the parent distribution can be specified. In the following examples the parent distrbution is "normal" (not shown because it is the default) and can be changed with the `distribution` argument. 

### Independent Samples (Wilcoxon-Mann-Whitney Test)

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.np.2means(mu1 = 30, mu2 = 28, sd1 = 12, sd2 = 8, kappa = 1, 
               power = .80, alpha = 0.05,
               alternative = "not equal")


```

### Paired Samples (Wilcoxon Signed-rank Test)

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.np.2means(mu1 = 30, mu2 = 28, sd1 = 12, sd2 = 8, 
               paired = TRUE, paired.r = 0.50,
               power = .80, alpha = 0.05,
               alternative = "not equal")

```

It is sufficient to put Cohen's *d* or Hedge's *g* (standardized difference between two groups) for `mu1` without specifying `mu2`, `sd1`, and `sd2`. 

## Non-inferiority, Superiority, and Equivalence 

These tests are useful for testing practically significant difference (non-inferiority, superiority) or practically null difference (equivalence). 

### Parametric Tests

**Non-inferiority**: Mean of group 1 is practically not smaller than the mean of group 2. The `mu1 - mu2` difference can be as small as -1 (`margin = -1`). When higher values of the outcome is better margin takes NEGATIVE values for non-inferiority test; whereas when lower values of the outcome is better margin takes POSITIVE values. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.t.2means(mu1 = 30, mu2 = 28, sd1 = 12, sd2 = 8, 
               margin = -1, power = 0.80,
               alternative = "non-inferior")
```

**Superiority**: Mean of group 1 is practically greater than the mean of group 2. The `mu1 - mu2` difference is at least greater than 1 (`margin = 1`). When higher values of the outcome is better margin takes POSITIVE values for non-inferiority test; whereas when lower values of the outcome is better margin takes NEGATIVE values. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.t.2means(mu1 = 30, mu2 = 28, sd1 = 12, sd2 = 8, 
               margin = 1, power = 0.80,
               alternative = "superior")
```

**Equivalence**: Mean of group 1 is practically same as mean of group 2. The `mu1 - mu2` difference can be as small as -1 and as high as 1 (`margin = 1`). Specify the absolute value for the margin. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.t.2means(mu1 = 30, mu2 = 30, sd1 = 12, sd2 = 8, 
               margin = 1, power = 0.80,
               alternative = "equivalent")
```

### Non-parametric Tests

**Non-inferiority**: Mean of group 1 is practically not smaller than the mean of group 2. The `mu1 - mu2` difference can be as small as -1 (`margin = -1`).

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.np.2means(mu1 = 30, mu2 = 28, sd1 = 12, sd2 = 8, 
               margin = -1, power = 0.80,
               alternative = "non-inferior")
```

**Superiority**: Mean of group 1 is practically greater than the mean of group 2. The `mu1 - mu2` difference is at least greater than 1 (`margin = 1`).

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.np.2means(mu1 = 30, mu2 = 28, sd1 = 12, sd2 = 8, 
               margin = 1, power = 0.80,
               alternative = "superior")
```

**Equivalence**: Mean of group 1 is practically same as mean of group 2. The `mu1 - mu2` difference can be as small as -1 and as high as 1 (`margin = 1`).

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE, warning = FALSE}
pwrss.np.2means(mu1 = 30, mu2 = 30, sd1 = 12, sd2 = 8, 
               margin = 1, power = 0.80,
               alternative = "equivalent")
```

<br>
<br>

# Multiple Linear Regression
<div style = "background-color:rgb(247, 247, 247); box-shadow: 4px 4px 4px rgb(220, 220, 220); padding:3px 3px 3px 3px; margin-top:0px; margin-bottom:10px;"></div>

## Omnibus $F$ Test 

### $R^2 > 0$ in Linear Regression

Omnibus F test in multiple liner regression is used to test whether $R^2$ is greater than 0 (zero). 
Assume that we want to predict a continuous variable $Y$ using $X_{1}$, $X_{2}$, and $X_{2}$ variables (a combination of binary or continuous).

$$\begin{eqnarray}
  Y_{i} &=& \beta_{0} + \beta_{1}X_{1} + \beta_{2}X_{2} + \beta_{3}X_{3} + r_{i}, \quad r_{i} \thicksim N(0,\sigma^2) \newline
  \end{eqnarray}$$

We are expecting that these three variables explain 30% of the variance in the outcome  ($R^2 = 0.30$). What is the minimum required sample size?  

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.f.reg(r2 = 0.30, k = 3, power = 0.80, alpha = 0.05)

```

### $\Delta R^2 > 0$ in Hierarchical Regression 

Assume that we want to add two more predictors to the earlier regression model ($X_{4}$, and $X_{5}$) and test whether increase in $R^2$ is greater than 0 (zero). We are expecting an increase of $\Delta R^2 = 0.15$. What is the minimum required sample size? 

$$\begin{eqnarray}
  Y_{i} &=& \beta_{0} + \beta_{1}X_{1} + \beta_{2}X_{2} + \beta_{3}X_{3} + \beta_{4}X_{4} + \beta_{5}X_{5} + r_{i}, \quad r_{i} \thicksim N(0,\sigma^2) \newline
  \end{eqnarray}$$

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.f.reg(r2 = 0.15, k = 5, m = 2, power = 0.80, alpha = 0.05)

```

## Single Regression Coefficient 

### Standardized versus Unstandardized Input

In the earlier example, assume that we want to predict a continuous variable $Y$ using a continuous predictor $X_{1}$ but control for $X_{2}$, and $X_{2}$ variables (a combination of binary or continuous). We are mainly interested in the effect of $X_{1}$ and expect a standardized regression coefficient of $\beta_{1} = 0.20$. 

$$\begin{eqnarray}
  Y_{i} &=& \beta_{0} + \color{red} {\beta_{1} X_{1}} + \beta_{2}X_{2} + \beta_{3}X_{3} + r_{i}, \quad r_{i} \thicksim N(0,\sigma^2) \newline
  \end{eqnarray}$$
  
Again, we are expecting that these three variables explain 30% of the variance in the outcome  ($R^2 = 0.30$). What is the minimum required sample size? It is sufficient to provide standardized regression coefficient for `beta1` because `sdx = 1` and `sdy = 1` by default. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.t.reg(beta1 = 0.20, k = 3, r2 = 0.30, 
            power = .80, alpha = 0.05, alternative = "not equal")
```

For unstandardized coefficients specify `sdy` and `sdx`. Assume we are expecting an unstandardized regression coefficient of `beta1 = 0.60`, a standard deviation of `sdy = 12` for the outcome and a standard deviation of `sdx = 4` for the main predictor. What is the minimum required sample size? 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.t.reg(beta1 = 0.60, sdy = 12, sdx = 4, k = 3, r2 = 0.30, 
            power = .80, alpha = 0.05, alternative = "not equal")

```

If $X_{1}$ variable is binary (e.g. treatment/control), the standardized regression coefficient is Cohen's *d*. Standard deviation of the main predictor is $\sqrt{p(1-p)}$ where *p* is the proportion of sample in one of the groups. Assume half of the sample is in the first group $p = 0.50$. What is the minimum required sample size? It is sufficient to provide Cohen's *d* for `beta1` (standardized difference between two groups) but specify `sdx = sqrt(p*(1-p))` where *p* is the proportion of subjects in one of the groups. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.t.reg(beta1 = 0.20, k = 3, r2 = 0.30, sdx = sqrt(0.50*(1-0.50)),
            power = .80, alpha = 0.05, alternative = "not equal")

```

### Non-inferiority, Superiority, and Equivalence

These tests are useful for testing practically significant effects (non-inferiority, superiority) or practically null effects (equivalence).

**Non-inferiority**: The intervention is expected to be non-inferior to some earlier or other interventions. Assume that the effect of an earlier or some other intervention is `beta0 = 0.10`. The `beta1 - beta0` is expected to be positive and should be at least -0.05 (`margin = -0.05`). This is the case when higher values of an outcome is better. When lower values of an outcome is better the `beta1 - beta0` difference is expected to be NEGATIVE and the `margin` takes POSITIVE values.

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.t.reg(beta1 = 0.20, beta0 = 0.10, margin = -0.05, 
            k = 3, r2 = 0.30, sdx = sqrt(0.50*(1-0.50)),
            power = .80, alpha = 0.05, alternative = "non-inferior")

```

**Superiority**: The intervention is expected to be superior to some earlier or other interventions. Assume that the effect of an earlier or some other intervention is `beta0 = 0.10`. The `beta1 - beta0` is expected to be positive and should be at least 0.05 (`margin = 0.05`). 
This is the case when higher values of an outcome is better. When lower values of an outcome is better and the `beta1 - beta0` difference is expected to be NEGATIVE and the `margin` takes NEGATIVE values.

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.t.reg(beta1 = 0.20, beta0 = 0.10, margin = 0.05, 
            k = 3, r2 = 0.30, sdx = sqrt(0.50*(1-0.50)),
            power = .80, alpha = 0.05, alternative = "superior")
```

**Equivalence**: The intervention is expected to be equivalent to some earlier or other interventions. Assume the effect of an earlier or some other intervention is `beta0 = 0.20`. The `beta1 - beta0` is expected to be within -0.05 and 0.05 (`margin = 0.05`). `margin` always takes positive values (absolute) for equivalence. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.t.reg(beta1 = 0.20, beta0 = 0.20, margin = 0.05, 
            k = 3, r2 = 0.30, sdx = sqrt(0.50*(1-0.50)),
            power = .80, alpha = 0.05, alternative = "equivalent")
```

<br>
<br>

# Indirect Effect in Mediation Analysis (*z* Test)
<div style = "background-color:rgb(247, 247, 247); box-shadow: 4px 4px 4px rgb(220, 220, 220); padding:3px 3px 3px 3px; margin-top:0px; margin-bottom:10px;"></div>

A simple mediation model can be constructed as in the figure. X is the main predictor, M is the mediator, and Y is the outcome. 

![**Simple Mediation Model**](med.tiff)

Regression models take the form of

$$\begin{eqnarray}
  M_i &=& \beta_{0M} + \color{red} {a} X_{i} + e_i\newline
  Y_i &=& \beta_{0Y} + \color{red} {b} M_{i} + \color{red} {cp} X_{i} + \epsilon_i \newline
  \end{eqnarray}$$

*a*, *b*, and *cp* path coefficients are needed to calculate the minimum required sample size. They can be standardized or unstandardized. By default, path coefficients are assumed to be standardized because standard deviation of the main predictor, mediator, and outcome is `sdx = 1`,  `sdm = 1`, and `sdy = 1`, respectively. For unstandardized regression coefficients `sdx`, `sdm`, and `sdy` should be specified (they can be found in descriptive tables in reports/publications).

## No Covariates 

**The main predictor is continuous:**

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
# X (cont.), M (cont.) , Y (cont.)
pwrss.z.med(a = 0.25, b = 0.25, cp = 0.10,
            power = 0.80, alpha = 0.05)
```

**The main predictor is binary (e.g. treatment/control):**

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
# X (binary), M (cont.) , Y (cont.)
p <- 0.50 # proportion of subjects in one group
pwrss.z.med(a = 0.25, b = 0.25, cp = 0.10, 
            sdx = sqrt(p*(1-p)), 
            power = 0.80, alpha = 0.05)
```

## With Covariates 

Covariates can be added to the mediator model, outcome model, or both. Explanatory power of the covariates (R-squared values) for the mediator and outcome models can be specified via `r2m.x` and `r2y.mx` arguments. 

**The main predictor is continuous:**

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
# X (cont.), M (cont.) , Y (cont.)
pwrss.z.med(a = 0.25, b = 0.25, cp = 0.10,
            r2m.x = 0.50, r2y.mx = 0.50, 
            power = 0.80, alpha = 0.05)
```

**The main predictor is binary (e.g. treatment/control):**

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
# X (binary), M (cont.) , Y (cont.)
p <- 0.50 # proportion of subjects in one group
pwrss.z.med(a = 0.25, b = 0.25, cp = 0.10,
            sdx = sqrt(p*(1-p)), 
            r2m.x = 0.50, r2y.mx = 0.50, 
            power = 0.80, alpha = 0.05)
```

<br>
<br>

# Analysis of (Co)Variance
<div style = "background-color:rgb(247, 247, 247); box-shadow: 4px 4px 4px rgb(220, 220, 220); padding:3px 3px 3px 3px; margin-top:0px; margin-bottom:10px;"></div>

## One-way

### ANOVA

A researcher is expecting a difference of Cohen's *d* = 0.50 between treatment and control groups (two levels) translating into $\eta^2 = 0.059$ (`eta2 = 0.059`). What is the minimum required sample size? 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.f.ancova(eta2 = 0.059, n.levels = 2,
               power = .80, alpha = 0.05)
```

### ANCOVA

A researcher is expecting an adjusted difference of Cohen's *d* = 0.45 between treatment and control groups (`n.levels = 2`) after controlling for the pretest (`n.cov = 1`) translating into partial $\eta^2 = 0.048$ (`eta2 = 0.048`). 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.f.ancova(eta2 = 0.048, n.levels = 2, n.cov = 1,
               alpha = 0.05, power = .80)
```

## Two-way

### ANOVA

A researcher is expecting a partial $\eta^2 = 0.03$ (`eta2 = 0.03`) for interaction of treatment/control (Factor A: two levels) with gender (Factor B: two levels). Thus, `n.levels = c(2,2)`.

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.f.ancova(eta2 = 0.03, n.levels = c(2,2),
               alpha = 0.05, power = 0.80)
```

### ANCOVA

A researcher is expecting a partial $\eta^2 = 0.02$ (`eta2 = 0.02`) for interaction of treatment/control (Factor A) with gender (Factor B) adjusted for the pretest (`n.covariates = 1`). 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.f.ancova(eta2 = 0.02, n.levels = c(2,2), n.cov = 1,
               alpha = 0.05, power = .80)
```

## Three-way 

### ANOVA

A researcher is expecting a partial $\eta^2 = 0.02$ (`eta2 = 0.02`) for interaction of treatment/control (Factor A: two levels), gender (Factor B: two levels), and socio-economic status (Factor C: three levels). Thus, `n.levels = c(2,2,3)`. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.f.ancova(eta2 = 0.02, n.levels = c(2,2,3),
               alpha = 0.05, power = 0.80)
```

### ANCOVA

A researcher is expecting a partial $\eta^2 = 0.01$ (`eta2 = 0.01`) for interaction of treatment/control (Factor A), gender (Factor B), and socio-economic status (Factor C: three levels) adjusted for the pretest (`n.covariates = 1`). 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.f.ancova(eta2 = 0.01, n.levels = c(2,2,3), n.cov = 1,
               alpha = 0.05, power = .80)
```

`n.cov` argument has trivial effect on the results. The difference between ANOVA and ANCOVA procedure depends on whether the effect (`eta2`) is unadjusted or covariate-adjusted. 

<br>
<br>

# Repeated Measures 
<div style = "background-color:rgb(247, 247, 247); box-shadow: 4px 4px 4px rgb(220, 220, 220); padding:3px 3px 3px 3px; margin-top:0px; margin-bottom:10px;"></div>

## Between Effect (Group)

**Example 1: Posttest only design with treatment and control groups.**

A researcher is expecting a difference of Cohen's *d* = 0.50 on the posttest score between treatment and control groups (`n.levels = 2`), translating into $\eta^2 = 0.059$ (`eta2 = 0.059`). The test is administered at a single time point; thus, the 'number of repeated measures' is `n.rm = 1`.

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.f.rmanova(eta2 = 0.059,  n.levels = 2, n.rm = 1,
                power = 0.80, alpha = 0.05,
                type = "between")
```


## Within Effect (Time)

**Example 2: Pretest-posttest design with treatment group only.**

A researcher is expecting a difference of Cohen's *d* = 0.30 between posttest and pretest scores, translating into $\eta^2 = 0.022$ (`eta2 = 0.022`). The test is administered before and after the treatment; thus, the 'number of repeated measures' is `n.rm = 2`. There is treatment group but no control group (`n.levels = 1`). The researcher also expects a correlation of 0.50 (`corr.rm = 0.50`) between pretest and posttest scores. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.f.rmanova(eta2 = 0.022,  n.levels = 1, n.rm = 2,
                power = 0.80, alpha = 0.05,
                corr.rm = 0.50, type = "within")
```

## Between-within Interaction (Group x Time)

**Example 3: Pretest-posttest control-group design.**

A researcher is expecting a difference of Cohen's *d* = 0.40 on the posttest scores between treatment and control groups (`n.levels = 2`) after controlling for pretest, translating into partial $\eta^2 = 0.038$ (`eta2 = 0.038`). The test is administered before and after the treatment; thus, the 'number of repeated measures' is `n.rm = 2`. The researcher also expects a correlation of 0.50 (`corr.rm = 0.50`) between pretest and posttest scores. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.f.rmanova(eta2 = 0.038,  n.levels = 2, n.rm = 2,
                power = 0.80, alpha = 0.05, 
                corr.rm = 0.50, type = "between")
```

A researcher is expecting a difference of Cohen's *d* = 0.30 between posttest and pretest scores (`n.rm = 2`) after controlling for group membership, translating into partial $\eta^2 = 0.022$ (`eta2 = 0.022`). There is both treatment and control groups (`n.levels = 2`). The researcher also expects a correlation of 0.50 (`corr.rm = 0.50`) between pretest and posttest scores. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.f.rmanova(eta2 = 0.022,  n.levels = 2, n.rm = 2,
                power = 0.80, alpha = 0.05, 
                corr.rm = 0.50, type = "within")
```

The rationale for inspecting the interaction is that the benefit of the treatment may depend on the pretest score (e.g. those with higher scores on the pretest improve or deteriorate more). A researcher is expecting an interaction effect of partial $\eta^2 = 0.01$ (`eta2 = 0.01`). The test is administered before and after the treatment; thus, the 'number of repeated measures' is `n.rm = 2`.  There is both treatment and control groups (`n.levels = 2`). The researcher also expects a correlation of 0.50 (`corr.rm = 0.50`) between pretest and posttest scores. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.f.rmanova(eta2 = 0.01,  n.levels = 2, n.rm = 2,
                power = 0.80, alpha = 0.05, 
                corr.rm = 0.50, type = "interaction")
```

<br>
<br>

# Goodness-of-fit or Independence ($\chi^2$ Test) 
<div style = "background-color:rgb(247, 247, 247); box-shadow: 4px 4px 4px rgb(220, 220, 220); padding:3px 3px 3px 3px; margin-top:0px; margin-bottom:10px;"></div>

## Vector of k Cells

**Effect size: Cohen's W for goodness-of-fit test for 1 x k or k x 1 table.**  

How many subjects are needed to claim that girls choose STEM related majors less than males? 
Check the original article at [https://www.aauw.org/resources/research/the-stem-gap/](https://www.aauw.org/resources/research/the-stem-gap/)

Option 1: Use cell probabilities <br>
Alternative hypothesis state that 28% of the workforce in STEM field is women whereas 72% is men (from the article).  
The null hypothesis assume 50% is women and 50% is men. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
prob.mat <- c(0.28, 0.72) 
pwrss.chisq.gofit(p1 = c(0.28, 0.72), p0 = c(0.50, 0.50),
                  alpha = 0.05, power = 0.80)
```

Option 2: Use Cohen's *W* = 0.44. <br>
Degrees of freedom is k - 1 for Cohen's *W*. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.chisq.gofit(w = 0.44, df = 1,
                  alpha = 0.05, power = 0.80)
```


## Contingency Table: 2 (row) x 2 (column) 

**Effect size: Phi Coefficient (or Cramer's V or Cohen's W) for independence test for 2 x 2 contingency table.**

How many subjects are needed to claim that girls are underdiagnosed with ADHD?  
Check the original article at [https://time.com/growing-up-with-adhd/](https://time.com/growing-up-with-adhd/)

Option 1: Use cell probabilities. <br>
5.6% of girls and 13.2% of boys are diagnosed with ADHD (from the article). 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
prob.mat <- rbind(c(0.056, 0.132),
                  c(0.944, 0.868))
colnames(prob.mat) <- c("Girl", "Boy")
rownames(prob.mat) <- c("ADHD", "No ADHD")
prob.mat
pwrss.chisq.gofit(p1 = prob.mat,
                  alpha = 0.05, power = 0.80)
```

Option 2: Use Phi coefficient = 0.1302134. <br>
Degrees of freedom is 1 for Phi coefficient. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.chisq.gofit(w = 0.1302134, df = 1,
                  alpha = 0.05, power = 0.80)

```


## Contingency Table: j (row) x k (column)  

**Effect size: Cramer's V (or Cohen's W) for independence test for j x k contingency tables.**

How many subjects are needed to detect the relationship between depression severity and gender?  
Check the original article at [https://doi.org/10.1016/j.jad.2019.11.121](https://doi.org/10.1016/j.jad.2019.11.121)

Option 1: Use cell probabilities (from the article). <br>

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
prob.mat <- cbind(c(0.6759, 0.1559, 0.1281, 0.0323, 0.0078),
                  c(0.6771, 0.1519, 0.1368, 0.0241, 0.0101))
rownames(prob.mat) <- c("Normal", "Mild", "Moderate", "Severe", "Extremely Severe")
colnames(prob.mat) <- c("Female", "Male")
prob.mat
pwrss.chisq.gofit(p1 = prob.mat,
                  alpha = 0.05, power = 0.80)
```

Option 2: Use Cramer's V = 0.03022008 based on 5 x 2 contingency table <br>
Degrees of freedom is (nrow - 1) * (ncol - 1) for Cramer's V.

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.chisq.gofit(w = 0.03022008, df = 4,
                  alpha = 0.05, power = 0.80)

```

<br>
<br>

# Logistic Regression (Wald's *z* Test)
<div style = "background-color:rgb(247, 247, 247); box-shadow: 4px 4px 4px rgb(220, 220, 220); padding:3px 3px 3px 3px; margin-top:0px; margin-bottom:10px;"></div>

In logistic regression a binary outcome variable (0/1: failed/passed, dead/alive, absent/present) is modeled by predicting probability of being in group 1 ($P_1$) via logit (natural logarithm of odds) transformation. The base rate $P_0$ is the overall probability of being in group 1 without influence of predictors in the model. When predictors are added, under alternative hypothesis, the probability of being in group 1 ($P_1$) deviate from $P_0$; whereas under null it is same as $P_0$. A model with one main predictor ($X_1$) and two other covariates ($X_2$ and $X_3$) can be constructed as

$$\begin{eqnarray}
  ln(\frac{P_1}{1- P_1}) &=& \beta_{0} + \color{red} {\beta_{1} X_{1}} + \beta_{2}X_{2} + \beta_{3}X_{3} \newline
  \end{eqnarray}$$

where <br> 
$$\beta_0 = ln(\frac{P_0}{1- P_0})$$ <br> 
$$\beta_1 = ln(\frac{P_1}{1- P_1} / \frac{P_0}{1- P_0})$$ <br> 
Odds ratio is defined as 
$$OR = exp(\beta_1) = \frac{P_1}{1- P_1} / \frac{P_0}{1- P_0}$$ <br> 

Assume that the multiple squared correlation between $X_1$ and ($X_2$,$X_3$) is $R^2_{X_1, (X_2,X_3)} = 0.20$. This is 0 (zero) by default implying that there are no covariates in the model besides the main predictor. It can be found in the form of adjusted $R^2$ via regressing $X_1$ on $X_2$ and $X_3$. <br>

There are three types of specification to power calculations; (i) probability specification, (ii) odds ratio specification, and (iii) regression coefficient specification (as in standard software output). 

Assume that the expected base rate is $P_0 = 0.15$. When a continuous predictor $X_1$ (follows normal) is added along with other covariates, the probability of being in group 1 becomes $P_1 = 0.10$. This means that increasing predictor $X_1$ by one unit reduces probability of being in group 1 from 0.15 to 0.10. What is the minimum required sample size? 

**Probability specification**: 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.logreg(p0 = 0.15, p1 = 0.10, r2.other.x = 0.20,
               power = 0.80, alpha = 0.05, 
               dist = "normal")
```

**Odds ratio specification**: 
$$OR = \frac{P_1}{1-P1} / \frac{P_0}{1-P_0} = \frac{0.10}{1-0.10} / \frac{0.15}{1-0.15} = 0.6296$$

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.logreg(p0 = 0.15, odds.ratio = 0.6296, r2.other.x = 0.20,
               alpha = 0.05, power = 0.80,
               dist = "normal")
```

**Regression coefficient specification**: 
$$\beta_1 = ln(\frac{P_1}{1-P1} / \frac{P_0}{1-P_0}) = ln(0.6296) = -0.4626$$ 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.logreg(p0 = 0.15, beta1 = -0.4626, r2.other.x = 0.20,
               alpha = 0.05, power = 0.80,
               dist = "normal")
```

By default, the mean and standard deviation of a normally distributed main predictor is 0 and 1, respectively. They can be changed. In the following example the mean and standard deviation is 10 and 2, respectively. 

**Change parameters of distribution of predictor X**: 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
dist.x <- list(dist = "normal", mean = 10, sd = 2)
pwrss.z.logreg(p0 = 0.15, beta1 = -0.4626, r2.other.x = 0.20,
               alpha = 0.05, power = 0.80,
               dist = dist.x)
```

The function accomodates other types of distribution. For example, the main predictor can be binary (e.g. treatment/control). Often a balanced sample is desired where half of the sample is in treatment group and the other half is in control group (`prob = 0.50` by default). 

**Change distribution family of predictor X**:

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.logreg(p0 = 0.15, beta1 = -0.4626, r2.other.x = 0.20,
               alpha = 0.05, power = 0.80,
               dist = "bernoulli")
```

**Change treatment group allocation rate of binary predictor X** (`prob = 0.40`): 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
dist.x <- list(dist = "bernoulli", prob = 0.40)
pwrss.z.logreg(p0 = 0.15, beta1 = -0.4626, r2.other.x = 0.20,
               alpha = 0.05, power = 0.80,
               dist = dist.x)
```

<br>
<br>

# Poisson Regression (Wald's *z* Test)
<div style = "background-color:rgb(247, 247, 247); box-shadow: 4px 4px 4px rgb(220, 220, 220); padding:3px 3px 3px 3px; margin-top:0px; margin-bottom:10px;"></div>

In poisson regression a count outcome variable (e.g. number of hospital/store/website visits, number of absence/dead/purchase in a day/week/month) is modeled by predicting incidence rate ($\lambda$) via logarithmic (natural logarithm of rates) transformation. A model with one main predictor ($X_1$) and two other covariates ($X_2$ and $X_3$) can be constructed as

$$\begin{eqnarray}
  ln(\lambda) &=& \beta_{0} + \color{red} {\beta_{1} X_{1}} + \beta_{2}X_{2} + \beta_{3}X_{3} \newline
  \end{eqnarray}$$

where $exp(\beta_0)$ is the base incidence rate. <br> 
$$\beta_1 = ln(\frac{\lambda(X_1=1)}{\lambda(X_1=0)})$$ <br> 
Rate ratio is defined as 
$$exp(\beta_1) = \frac{\lambda(X_1=1)}{\lambda(X_1=0)}$$<br>

There are two types of specification; (i) rate ratio specification (exponentiated regression coefficient), and (ii) the raw regression coefficient specification (as in standard software output). 

Assume that the expected base rate is $exp(0.50) = 1.65$ and when a continuous predictor $X_1$ (follows normal) is added to the model along with other covariates the expected rate becomes $exp(-0.10) = 0.905$. This means that increasing predictor $X_1$ by one unit reduces reduces the mean incidence rate from 1.65 to 0.905. What is the minimum required sample size? 

**Regression coefficient specification**:

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.poisreg(beta0 = 0.50, beta1 = -0.10,
                power = 0.80, alpha = 0.05, 
                dist = "normal")
```

**Rate ratio specification**:

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.poisreg(exp.beta0 = exp(0.50),
                exp.beta1 = exp(-0.10),
                power = 0.80, alpha = 0.05, 
                dist = "normal")
```

**Change parameters of distribution of predictor X**: 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
dist.x <- list(dist = "normal", mean = 10, sd = 2)
pwrss.z.poisreg(exp.beta0 = exp(0.50),
                exp.beta1 = exp(-0.10),
                alpha = 0.05, power = 0.80,
                dist = dist.x)
```

The function accomodates other types of distribution. For example, the main predictor can be binary (e.g. treatment/control). 

**Regression coefficient specification**:

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.poisreg(beta0 = 0.50, beta1 = -0.10,
                alpha = 0.05, power = 0.80,
                dist = "bernoulli")
```

**Rate ratio specification**:

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.poisreg(exp.beta0 = exp(0.50),
                exp.beta1 = exp(-0.10),
                alpha = 0.05, power = 0.80,
                dist = "bernoulli")
```

**Change treatment group allocation rate of the binary predictor X** (`prob = 0.40`):

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
dist.x <- list(dist = "bernoulli", prob = 0.40)
pwrss.z.poisreg(exp.beta0 = exp(0.50),
                exp.beta1 = exp(-0.10),
                alpha = 0.05, power = 0.80,
                dist = dist.x)
```

<br>
<br>

# Single Correlation
<div style = "background-color:rgb(247, 247, 247); box-shadow: 4px 4px 4px rgb(220, 220, 220); padding:3px 3px 3px 3px; margin-top:0px; margin-bottom:10px;"></div>

**One-sided Test**: Assume that the expected correlation is 0.20 and it is greater than 0.10. What is the minimum required sample size? 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.corr(r = 0.20, r0 = 0.10,
             power = 0.80, alpha = 0.05, 
             alternative = "greater")
```

**Two-sided Test**: Assume that the expected correlation is 0.20 and it is different from 0 (zero). The correlation could be 0.20 as well as -0.20. What is the minimum required sample size? 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.corr(r = 0.20, r0 = 0,
             power = 0.80, alpha = 0.05, 
             alternative = "not equal")
```

<br>
<br>

# Two Correlations (Independent Samples) 
<div style = "background-color:rgb(247, 247, 247); box-shadow: 4px 4px 4px rgb(220, 220, 220); padding:3px 3px 3px 3px; margin-top:0px; margin-bottom:10px;"></div>

Assume that the expected correlations in the first and second groups are 0.30 and 0.20, respectively (`r1 = 0.30` and `r2 = 0.20`). 

**One-sided Test**: Expecting `r1 - r2` greater than 0 (zero). The difference could be 0.10 but could not be -0.10. What is the minimum required sample size? 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.2corrs(r1 = 0.30, r2 = 0.20,
               power = .80, alpha = 0.05, 
               alternative = "greater")
```

**Two-sided Test**: Expecting `r1 - r2` different from 0 (zero). The difference could be -0.10 as well as 0.10. What is the minimum required sample size? 
```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.2corrs(r1 = 0.30, r2 = 0.20,
               power = .80, alpha = 0.05, 
               alternative = "not equal")
```

<br>
<br>

# Single Proportion 
<div style = "background-color:rgb(247, 247, 247); box-shadow: 4px 4px 4px rgb(220, 220, 220); padding:3px 3px 3px 3px; margin-top:0px; margin-bottom:10px;"></div>

In the following examples `p` is the proportion under alternative hypothesis and `p0` is the proportion under null hypothesis. 

**One-sided Test**: Expecting `p - p0` smaller than 0 (zero).

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
# normal approximation
pwrss.z.prop(p = 0.45, p0 = 0.50,
             alpha = 0.05, power = 0.80,
             alternative = "less",
             arcsin.trans = FALSE)

# arcsine transformation
pwrss.z.prop(p = 0.45, p0 = 0.50,
             alpha = 0.05, power = 0.80,
             alternative = "less",
             arcsin.trans = TRUE)
```

**Two-sided Test**: Expecting `p - p0` smaller than 0 (zero) or greater than 0 (zero). 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.prop(p = 0.45, p0 = 0.50,
             alpha = 0.05, power = 0.80,
             alternative = "not equal")
```

**Non-inferiority Test**: The case when smaller proportion is better. Expecting `p - p0` smaller than 0.01. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.prop(p = 0.45, p0 = 0.50, margin = 0.01,
             alpha = 0.05, power = 0.80,
             alternative = "non-inferior")
```

**Non-inferiority Test**: The case when bigger proportion is better. Expecting `p - p0` greater than -0.01.

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.prop(p = 0.55, p0 = 0.50, margin = -0.01,
             alpha = 0.05, power = 0.80,
             alternative = "non-inferior")
```

**Superiority Test**: The case when smaller proportion is better. Expecting `p - p0` smaller than -0.01.

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.prop(p = 0.45, p0 = 0.50, margin = -0.01,
             alpha = 0.05, power = 0.80,
             alternative = "superior")
```

**Superiority Test**: The case when bigger proportion is better. Expecting `p - p0` greater than 0.01.

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.prop(p = 0.55, p0 = 0.50, margin = 0.01,
             alpha = 0.05, power = 0.80,
             alternative = "superior")
```

**Equivalence Test*: Expecting `p - p0` between -0.01 and 0.01.

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.prop(p = 0.50, p0 = 0.50, margin = 0.01,
             alpha = 0.05, power = 0.80,
             alternative = "equivalent")
```

<br>
<br>

# Two Proportions (Independent Samples)
<div style = "background-color:rgb(247, 247, 247); box-shadow: 4px 4px 4px rgb(220, 220, 220); padding:3px 3px 3px 3px; margin-top:0px; margin-bottom:10px;"></div>

In the following examples `p1` and `p2` are proportions for the first and second groups under alternative hypothesis. The null hypothesis state `p1 = p2` or `p1 - p2 = 0`.  

**One-sided Test**: Expecting `p1 - p2` smaller than 0 (zero).

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
# normal approximation
pwrss.z.2props(p1 = 0.45, p2 = 0.50,
               alpha = 0.05, power = 0.80,
               alternative = "less",
               arcsin.trans = FALSE)
# arcsine transformation
pwrss.z.2props(p1 = 0.45, p2 = 0.50,
               alpha = 0.05, power = 0.80,
               alternative = "less",
               arcsin.trans = TRUE)
```

**Two-sided Test**: Expecting `p1 - p2` smaller than 0 (zero) or greater than 0 (zero). 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.2props(p1 = 0.45, p2 = 0.50,
               alpha = 0.05, power = 0.80,
               alternative = "not equal")
```

**Non-inferiority Test**: The case when smaller proportion is better. Expecting `p1 - p2` smaller than 0.01. 

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.2props(p1 = 0.45, p2 = 0.50, margin = 0.01,
               alpha = 0.05, power = 0.80,
               alternative = "non-inferior")
```

**Non-inferiority Test**: The case when bigger proportion is better. Expecting `p1 - p2` greater than -0.01.

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.2props(p1 = 0.55, p2 = 0.50,  margin = -0.01,
               alpha = 0.05, power = 0.80,
               alternative = "non-inferior")
```

**Superiority Test**: The case when smaller proportion is better. Expecting `p1 - p2` smaller than -0.01.

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.2props(p1 = 0.45, p2 = 0.50, margin = -0.01,
               alpha = 0.05, power = 0.80,
               alternative = "superior")
```

**Superiority Test**: The case when bigger proportion is better. Expecting `p1 - p2` greater than 0.01.

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.2props(p1 = 0.55, p2 = 0.50, margin = 0.01,
               alpha = 0.05, power = 0.80,
               alternative = "superior")
```

**Equivalence Test**: Expecting `p1 - p2` between -0.01 and 0.01.

```{r, message = FALSE, fig.width = 7, fig.height = 5, results = TRUE}
pwrss.z.2props(p1 = 0.50, p2 = 0.50, margin = 0.01,
               alpha = 0.05, power = 0.80,
               alternative = "equivalent")
```

--o-- <br>
*The end of the document.* 
<div style = "background-color:rgb(245, 245, 245); padding:5px 5px 5px 5px;">
Please send any bug reports, feedback or questions to [bulusmetin [at] gmail.com](mailto:bulusmetin@gmail.com). 
</div>

